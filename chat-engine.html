<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Onet Emotia â€” Chat Engine</title>

  <!-- FONT + CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./chat-engine.css" />
</head>

<body>
  <!-- ===== THEME TOGGLE & LOGOUT ===== -->
  <button id="themeToggle" title="Switch Theme">ðŸŒ“</button>

  <!-- Top logout button (JS also attaches logout behavior) -->
  <button 
    id="logoutBtn" 
    title="Logout" 
    style="position:absolute;top:15px;right:15px;background:transparent;
           border:2px solid var(--accent);color:var(--accent);
           border-radius:10px;padding:6px 10px;cursor:pointer;">
    Logout
  </button>

  <!-- Mobile menu toggle -->
  <button id="menuToggle" class="menu-btn" aria-label="Toggle menu">â˜°</button>

  <!-- ===== POPUP NOTIFICATION ===== -->
  <div id="chatPopup"></div>

  <!-- ===== CHAT APP CONTAINER ===== -->
  <div id="chatApp">
    <!-- ===== Sidebar (User List) ===== -->
    <aside id="chatList" aria-label="Chats sidebar">
      <h2 style="font-weight:800;margin-bottom:10px;">Chats ðŸ’¬</h2>
      <input id="chatSearch" type="text" placeholder="Search users..."
             style="width:100%;padding:8px;border:none;border-radius:10px;
                    margin-bottom:12px;font-size:14px;" />
      <div id="userListContainer" style="flex:1;overflow-y:auto;"></div>
    </aside>

    <!-- ===== Main Chat (Right Side) ===== -->
    <section id="chatBox" aria-live="polite">
      <header id="chatHeader">
        <div class="chat-user-head">
          <div class="avatar" id="chatAvatar">ðŸ™‚</div>
          <div>
            <div class="name" id="chatUsername">Select a user</div>
            <div class="sub muted" id="chatMood">Ready to vibe</div>
          </div>
        </div>
      </header>

      <div class="messages-wrapper">
        <div class="messages-container" id="messagesContainer" role="log" aria-atomic="false"></div>

        <div id="typingIndicator" style="display:none;padding:8px 12px;font-size:13px;opacity:0.85;"></div>

        <div id="inputBar" style="display:flex;gap:8px;align-items:flex-end;padding:12px;">
          <textarea id="msgInput" placeholder="Type a message..." rows="2" style="flex:1;resize:none;border-radius:10px;padding:10px;"></textarea>
          <button id="sendBtn" aria-label="Send message">âž¤</button>
        </div>
      </div>
    </section>
  </div>

  <!-- ===== BACKGROUND FX ===== -->
  <canvas id="glowCanvas"
          style="position:fixed;top:0;left:0;width:100%;height:100%;
                 z-index:-1;pointer-events:none;"></canvas>
  <!-- ===== BACKGROUND GLOW SCRIPT ===== -->
  <script>
    const canvas = document.getElementById("glowCanvas");
    const ctx = canvas.getContext("2d");
    let w, h;

    function resize() {
      w = canvas.width = window.innerWidth;
      h = canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resize);
    resize();

    const orbs = Array(15).fill().map(() => ({
      x: Math.random() * w,
      y: Math.random() * h,
      r: Math.random() * 80 + 40,
      dx: Math.random() * 2 - 1,
      dy: Math.random() * 2 - 1,
      c: `hsl(${Math.random() * 360},80%,60%)`
    }));

    function animate() {
      ctx.clearRect(0, 0, w, h);
      orbs.forEach(o => {
        ctx.beginPath();
        const g = ctx.createRadialGradient(o.x, o.y, 0, o.x, o.y, o.r);
        g.addColorStop(0, o.c);
        g.addColorStop(1, "transparent");
        ctx.fillStyle = g;
        ctx.arc(o.x, o.y, o.r, 0, Math.PI * 2);
        ctx.fill();
        o.x += o.dx; o.y += o.dy;
        if (o.x < 0 || o.x > w) o.dx *= -1;
        if (o.y < 0 || o.y > h) o.dy *= -1;
      });
      requestAnimationFrame(animate);
    }
    animate();
  </script>
  <!-- ===== CHAT ENGINE (merged) ===== -->
  <script type="module" src="./chat-engine.js"></script>


  <!-- ===== ENTRY ANIMATION ===== -->
  <style>
    #chatApp {
      display: flex;
      height: 100vh;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeIn 1s ease forwards;
      animation-delay: 0.3s;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Minimal fade-out helper used by JS for delete animation */
    .fade-out {
      opacity: 0 !important;
      transform: translateY(-6px);
      transition: all 380ms ease;
    }
  </style>
  
  
</body>
</html>